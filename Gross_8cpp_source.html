<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AGA8 WebAssembly: src/cpp/Gross.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/sctg-development/aga8-js" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AGA8 WebAssembly
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">bindings for AGA8 gas properties calculations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('Gross_8cpp_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Gross.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="Gross_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="comment">/*</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="comment">This software was developed by employees of the National Institute of Standards and Technology (NIST), </span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="comment">an agency of the Federal Government and is being made available as a public service. Pursuant to title 17 </span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="comment">United States Code Section 105, works of NIST employees are not subject to copyright protection in the </span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="comment">United States. This software may be subject to foreign copyright. Permission in the United States and in </span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="comment">foreign countries, to the extent that NIST may hold copyright, to use, copy, modify, create derivative works, </span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="comment">and distribute this software and its documentation without fee is hereby granted on a non-exclusive basis, </span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="comment">provided that this notice and disclaimer of warranty appears in all copies.</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="comment"></span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="comment">THE SOFTWARE IS PROVIDED &#39;AS IS&#39; WITHOUT ANY WARRANTY OF ANY KIND, EITHER EXPRESSED, IMPLIED, OR STATUTORY, </span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="comment">INCLUDING, BUT NOT LIMITED TO, ANY WARRANTY THAT THE SOFTWARE WILL CONFORM TO SPECIFICATIONS, ANY IMPLIED </span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="comment">WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND FREEDOM FROM INFRINGEMENT, AND ANY </span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="comment">WARRANTY THAT THE DOCUMENTATION WILL CONFORM TO THE SOFTWARE, OR ANY WARRANTY THAT THE SOFTWARE WILL BE </span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment">ERROR FREE. IN NO EVENT SHALL NIST BE LIABLE FOR ANY DAMAGES, INCLUDING, BUT NOT LIMITED TO, DIRECT, INDIRECT, </span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="comment">SPECIAL OR CONSEQUENTIAL DAMAGES, ARISING OUT OF, RESULTING FROM, OR IN ANY WAY CONNECTED WITH THIS SOFTWARE, </span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="comment">WHETHER OR NOT BASED UPON WARRANTY, CONTRACT, TORT, OR OTHERWISE, WHETHER OR NOT INJURY WAS SUSTAINED BY </span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="comment">PERSONS OR PROPERTY OR OTHERWISE, AND WHETHER OR NOT LOSS WAS SUSTAINED FROM, OR AROSE OUT OF THE RESULTS OF, </span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="comment">OR USE OF, THE SOFTWARE OR SERVICES PROVIDED HEREUNDER.</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="comment">*/</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="comment">//  **********  This code is preliminary, and will be updated.  **********</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="comment">//  **********  Use only for beta testing.  **********</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="comment">//  **********  June 7, 2016  **********</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#include &quot;<a class="code" href="Gross_8h.html">Gross.h</a>&quot;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="comment">// We add both math headers to placate some non-standards-compliant compilers</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span> </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="comment">// Version 2.0 of routines for the calculation of thermodynamic</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="comment">// properties from the AGA 8 Part 1 GROSS equation of state.</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="comment">// April, 2017</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="comment">// Written by Eric W. Lemmon</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="comment">// Applied Chemicals and Materials Division</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="comment">// National Institute of Standards and Technology (NIST)</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="comment">// Boulder, Colorado, USA</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="comment">// Eric.Lemmon@nist.gov</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="comment">// 303-497-7939</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="comment">// C++ translation by Ian H. Bell</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="comment">// Applied Chemicals and Materials Division</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="comment">// National Institute of Standards and Technology (NIST)</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="comment">// Boulder, Colorado, USA</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="comment">// ian.bell@nist.gov</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span><span class="comment">// Other contributors:</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="comment">// Volker Heinemann, RMG Messtechnik GmbH</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span><span class="comment">// Jason Lu, Thermo Fisher Scientific</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><span class="comment">// Ian Bell, NIST</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="comment">// The publication for the AGA 8 equation of state is available from AGA</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="comment">//   and the Transmission Measurement Committee.</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="comment">// Subroutines contained here for property calculations:</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="comment">// ***** Subroutine SetupGross must be called once before calling other routines. ******</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="comment">// Function prototypes</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a957c10103f9962948a361b94ad63dda1">Bmix</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> T, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> HCH, <span class="keywordtype">double</span> &amp;B, <span class="keywordtype">double</span> &amp;C, <span class="keywordtype">int</span> &amp;ierr, std::string &amp;herr);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#ae1798b648878f99010e0fb654a6b5590">MolarMassGross</a>(<span class="keyword">const</span> std::vector&lt;double&gt; &amp;x, <span class="keywordtype">double</span> &amp;Mm);</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a789a45b2ee42f8b3ceeb66df81b1ce0c">PressureGross</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> T, <span class="keyword">const</span> <span class="keywordtype">double</span> D, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> HCH, <span class="keywordtype">double</span> &amp;P, <span class="keywordtype">double</span> &amp;Z, <span class="keywordtype">int</span> &amp;ierr, std::string &amp;herr);</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a738cf70144adce3acb490595d4bab51f">DensityGross</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> T, <span class="keyword">const</span> <span class="keywordtype">double</span> P, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> HCH, <span class="keywordtype">double</span> &amp;D, <span class="keywordtype">int</span> &amp;ierr, std::string &amp;herr);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a34daee09a7d0b0ed0c118b25ef565a6b">GrossHv</a>(<span class="keyword">const</span> std::vector&lt;double&gt; &amp;x, std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keywordtype">double</span> &amp;HN, <span class="keywordtype">double</span> &amp;HCH);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#aab13d9f5b32d4fe6789481b5edc7cb1e">GrossInputs</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> T, <span class="keyword">const</span> <span class="keywordtype">double</span> P, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;x, std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keywordtype">double</span> &amp;Gr, <span class="keywordtype">double</span> &amp;HN, <span class="keywordtype">double</span> &amp;HCH, <span class="keywordtype">int</span> &amp;ierr, std::string &amp;herr);</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a823e84884715c2fa0ba5ccbc9f6761b7">SetupGross</a>();</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="comment">// &#39;The compositions in the x() array use the following order and must be sent as mole fractions:</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span><span class="comment">// &#39;    0 - PLACEHOLDER</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="comment">// &#39;    1 - Methane</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="comment">// &#39;    2 - Nitrogen</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="comment">// &#39;    3 - Carbon dioxide</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span><span class="comment">// &#39;    4 - Ethane</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="comment">// &#39;    5 - Propane</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span><span class="comment">// &#39;    6 - Isobutane</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="comment">// &#39;    7 - n-Butane</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span><span class="comment">// &#39;    8 - Isopentane</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span><span class="comment">// &#39;    9 - n-Pentane</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span><span class="comment">// &#39;   10 - n-Hexane</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span><span class="comment">// &#39;   11 - n-Heptane</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><span class="comment">// &#39;   12 - n-Octane</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span><span class="comment">// &#39;   13 - n-Nonane</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span><span class="comment">// &#39;   14 - n-Decane</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span><span class="comment">// &#39;   15 - Hydrogen</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span><span class="comment">// &#39;   16 - Oxygen</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span><span class="comment">// &#39;   17 - Carbon monoxide</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span><span class="comment">// &#39;   18 - Water</span></div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span><span class="comment">// &#39;   19 - Hydrogen sulfide</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span><span class="comment">// &#39;   20 - Helium</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span><span class="comment">// &#39;   21 - Argon</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span><span class="comment">// &#39;</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span><span class="comment">// &#39;For example, a mixture (in moles) of 94% methane, 5% CO2, and 1% helium would be (in mole fractions):</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span><span class="comment">// &#39;x(1)=0.94, x(3)=0.05, x(20)=0.01</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="comment">// Variables containing the common parameters in the GROSS equations</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">  125</a></span><span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a31983b0d2f1ecdbb8aeb2a5280c579bb">  126</a></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="Gross_8cpp.html#a9f33884b6f58c450cee327af3a17cc3a">NcGross</a> = 21, <a class="code hl_variable" href="Detail_8cpp.html#a31983b0d2f1ecdbb8aeb2a5280c579bb">MaxFlds</a> = 21;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#ac29df3dcbefa1ce189e5990bde994025">  127</a></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="Detail_8cpp.html#ac29df3dcbefa1ce189e5990bde994025">epsilon</a> = 1e-15;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#ac781385d6450b283663de0cf6d4253b7">  128</a></span><span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="Gross_8cpp.html#a418bd4a5071b601ba760a723a64201fe">mN2</a>, <a class="code hl_variable" href="Gross_8cpp.html#a91d30f8476b8687ca8b7e800926abc7c">mCO2</a>, <a class="code hl_variable" href="Detail_8cpp.html#ac781385d6450b283663de0cf6d4253b7">dPdDsave</a>;</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">  129</a></span><span class="keyword">static</span> <span class="keywordtype">double</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[<a class="code hl_variable" href="Detail_8cpp.html#a31983b0d2f1ecdbb8aeb2a5280c579bb">MaxFlds</a>+1] , <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[<a class="code hl_variable" href="Detail_8cpp.html#a31983b0d2f1ecdbb8aeb2a5280c579bb">MaxFlds</a>+1]; <span class="comment">// +1 since C/C++ is 0-based indexing</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a458a3a52c606eb8634c3bd9a80458d19">  130</a></span><span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="Gross_8cpp.html#a458a3a52c606eb8634c3bd9a80458d19">b0</a>[4][4], <a class="code hl_variable" href="Gross_8cpp.html#a7aef5ea4cd3449adb6c41acb4fe1ee22">b1</a>[4][4], <a class="code hl_variable" href="Gross_8cpp.html#a9111038880f189f71b555792bb135149">b2</a>[4][4], <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[3][3], <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[3][3];</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a551f4167338c4bdf1e3c672d717d8387">  131</a></span><span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="Gross_8cpp.html#a551f4167338c4bdf1e3c672d717d8387">c0</a>[4][4][4], <a class="code hl_variable" href="Gross_8cpp.html#a50c04abf4d8d551ed2bc1fc79a8f711e">c1</a>[4][4][4], <a class="code hl_variable" href="Gross_8cpp.html#a677b8fa6a606817e8087983862e45c5c">c2</a>[4][4][4];</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span></div>
<div class="foldopen" id="foldopen00143" data-start="{" data-end="}">
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#ae1798b648878f99010e0fb654a6b5590">  143</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#ae1798b648878f99010e0fb654a6b5590">MolarMassGross</a>(<span class="keyword">const</span> std::vector&lt;double&gt; &amp;x, <span class="keywordtype">double</span> &amp;Mm)</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>{</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span><span class="comment">// Sub MolarMassGross(x, Mm)</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span><span class="comment">// Calculate molar mass of the mixture with the compositions contained in the x() input array</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span><span class="comment">// Inputs:</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span><span class="comment">//    x() - Composition (mole fraction)</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span><span class="comment">//          Do not send mole percents or mass fractions in the x() array, otherwise the output will be incorrect.</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span><span class="comment">//          The sum of the compositions in the x() array must be equal to one.</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="comment">//          The order of the fluids in this array is given at the top of this code.</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span><span class="comment">// Outputs:</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span><span class="comment">//     Mm - Molar mass (g/mol)</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  Mm = 0;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>  <span class="keywordflow">for</span>(std::size_t i = 1; i &lt;= <a class="code hl_variable" href="Gross_8cpp.html#a9f33884b6f58c450cee327af3a17cc3a">NcGross</a>; ++i){</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    Mm += x[i] * <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[i];</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>  }</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>}</div>
</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span></div>
<div class="foldopen" id="foldopen00183" data-start="{" data-end="}">
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a789a45b2ee42f8b3ceeb66df81b1ce0c">  183</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a789a45b2ee42f8b3ceeb66df81b1ce0c">PressureGross</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> T, <span class="keyword">const</span> <span class="keywordtype">double</span> D, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> HCH, <span class="keywordtype">double</span> &amp;P, <span class="keywordtype">double</span> &amp;Z, <span class="keywordtype">int</span> &amp;ierr, std::string &amp;herr)</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>{</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="comment">// Sub PressureGross(T, D, xGrs, HCH, P, Z, ierr, herr)</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="comment">// Calculate pressure as a function of temperature and density.  The derivative d(P)/d(D) is also calculated</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="comment">// for use in the iterative DensityGross subroutine (and is only returned as a common variable).</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="comment">// </span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <span class="comment">// Inputs:</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    <span class="comment">//      T - Temperature (K)</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    <span class="comment">//      D - Density (mol/l)</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <span class="comment">//   xGrs - Compositions of the equivalent hydrocarbon, nitrogen, and CO2 (mole fractions)</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="comment">//    HCH - Molar ideal gross heating value of the equivalent hydrocarbon (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <span class="comment">//          *** Call subroutine GrossHv or GrossInputs first to obtain HCH. ***</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    <span class="comment">// </span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="comment">// Outputs:</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="comment">//      P - Pressure (kPa)</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    <span class="comment">//      Z - Compressibility factor</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="comment">//   ierr - Error number (0 indicates no error)</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    <span class="comment">//   herr - Error message if ierr is not equal to zero</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    <span class="comment">//   dPdDsave - d(P)/d(D) [kPa/(mol/l)] (at constant temperature)</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <span class="comment">//            - This variable is cached in the common variables for use in the iterative density solver, but not returned as an argument.</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="keywordtype">double</span> B = 1e30, C = 1e30;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    Z = 1;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    P = D*<a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>*T;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <a class="code hl_function" href="Gross_8cpp.html#a957c10103f9962948a361b94ad63dda1">Bmix</a>(T, <a class="code hl_struct" href="structxGrs.html">xGrs</a>, HCH, B, C, ierr, herr);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <span class="keywordflow">if</span> (ierr &gt; 0) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    Z = 1 + B*D + C*pow(D, 2);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    P = D*<a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>*T*Z;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <a class="code hl_variable" href="Detail_8cpp.html#ac781385d6450b283663de0cf6d4253b7">dPdDsave</a> = <a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>*T*(1 + 2*B*D + 3*C*D*D);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    <span class="keywordflow">if</span> (P &lt; 0){</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        ierr = -1;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>        herr = <span class="stringliteral">&quot;Pressure is negative in the GROSS method.&quot;</span>;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    }</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>}</div>
</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span></div>
<div class="foldopen" id="foldopen00236" data-start="{" data-end="}">
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a738cf70144adce3acb490595d4bab51f">  236</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a738cf70144adce3acb490595d4bab51f">DensityGross</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> T, <span class="keyword">const</span> <span class="keywordtype">double</span> P, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> HCH, <span class="keywordtype">double</span> &amp;D, <span class="keywordtype">int</span> &amp;ierr, std::string &amp;herr)</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>{</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="comment">// Sub DensityGross(T, P, xGrs, HCH, D, ierr, herr)</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="comment">// Calculate density as a function of temperature and pressure.  This is an iterative routine that calls PressureGross</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="comment">// to find the correct state point.  Generally only 6 iterations at most are required.</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    <span class="comment">// If the iteration fails to converge, the ideal gas density and an error message are returned.</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    <span class="comment">// Inputs:</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <span class="comment">//      T - Temperature (K)</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <span class="comment">//      P - Pressure (kPa)</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <span class="comment">//   xGrs - Compositions of the equivalent hydrocarbon, nitrogen, and CO2 (mole fractions)</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <span class="comment">//    HCH - Molar ideal gross heating value of the hydrocarbon components (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    <span class="comment">//          *** Call subroutine GrossHv or GrossInputs first to obtain HCH. ***</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    <span class="comment">// Outputs:</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    <span class="comment">//      D - Density (mol/l)</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    <span class="comment">//   ierr - Error number (0 indicates no error)</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <span class="comment">//   herr - Error message if ierr is not equal to zero</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    <span class="keywordtype">double</span> plog, vlog, P2, Z, dpdlv, vdiff, tolr;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    ierr = 0;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    herr = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <span class="keywordflow">if</span> (P &lt; <a class="code hl_variable" href="Detail_8cpp.html#ac29df3dcbefa1ce189e5990bde994025">epsilon</a>){</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        D = 0; <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    } </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    tolr = 0.0000001;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    D = P / <a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a> / T;       <span class="comment">//Ideal gas estimate</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    plog = log(P);</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    vlog = -log(D);</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> it = 1; it &lt;= 20; ++it){</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        <span class="keywordflow">if</span>(vlog &lt; -7 || vlog &gt; 100){</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>            ierr = 1;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>            herr = <span class="stringliteral">&quot;Calculation failed to converge in GROSS method, ideal gas density returned.&quot;</span>;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>            D = P/<a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>/T;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        }</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>        D = exp(-vlog);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>        <a class="code hl_function" href="Gross_8cpp.html#a789a45b2ee42f8b3ceeb66df81b1ce0c">PressureGross</a>(T, D, <a class="code hl_struct" href="structxGrs.html">xGrs</a>, HCH, P2, Z, ierr, herr);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        <span class="keywordflow">if</span> (ierr &gt; 0){ <span class="keywordflow">return</span>; }</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="Detail_8cpp.html#ac781385d6450b283663de0cf6d4253b7">dPdDsave</a> &lt; <a class="code hl_variable" href="Detail_8cpp.html#ac29df3dcbefa1ce189e5990bde994025">epsilon</a> || P2 &lt; <a class="code hl_variable" href="Detail_8cpp.html#ac29df3dcbefa1ce189e5990bde994025">epsilon</a>){</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>            vlog += 0.1;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        }</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>            <span class="comment">// Find the next density with a first order Newton&#39;s type iterative scheme, with</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>            <span class="comment">// log(P) as the known variable and log(v) as the unknown property.</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>            <span class="comment">// See AGA 8 publication for further information.</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>            dpdlv = -D * <a class="code hl_variable" href="Detail_8cpp.html#ac781385d6450b283663de0cf6d4253b7">dPdDsave</a>;     <span class="comment">// d(p)/d[log(v)]</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>            vdiff = (log(P2) - plog) * P2 / dpdlv;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            vlog = vlog - vdiff;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>            <span class="keywordflow">if</span> (std::abs(vdiff) &lt; tolr){</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>                <span class="keywordflow">if</span> (P2 &lt; 0){</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>                    ierr = 10;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>                    herr = <span class="stringliteral">&quot;Calculation failed to converge in the GROSS method, ideal gas density returned.&quot;</span>;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>                    D = P/<a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>/T;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>                }</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>                <span class="comment">// Iteration converged</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>                D = exp(-vlog);</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>            }</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        }</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    }</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    ierr = 10;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    herr = <span class="stringliteral">&quot;Calculation failed to converge in the GROSS method, ideal gas density returned.&quot;</span>;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    D = P/<a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>/T;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>}</div>
</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span></div>
<div class="foldopen" id="foldopen00317" data-start="{" data-end="}">
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a34daee09a7d0b0ed0c118b25ef565a6b">  317</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a34daee09a7d0b0ed0c118b25ef565a6b">GrossHv</a>(<span class="keyword">const</span> std::vector&lt;double&gt; &amp;x, std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keywordtype">double</span> &amp;HN, <span class="keywordtype">double</span> &amp;HCH)</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>{</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    <span class="comment">// Sub GrossHv(x, xGrs, HN, HCH)</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <span class="comment">// Calculate ideal heating values based on composition.  The mole fractions in the mixture are required in this routine, not</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="comment">//   just xCH, xN2, and xCO2.</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <span class="comment">// Inputs:</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <span class="comment">//     x - Molar compositions of all components in the mixture.  The order in this array is given at the top of this code.</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <span class="comment">// Outputs:</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <span class="comment">//  xGrs - Compositions of the equivalent hydrocarbon, nitrogen, and CO2 (mole fractions)</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    <span class="comment">//    HN - Molar ideal gross heating value of the mixture (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    <span class="comment">//   HCH - Molar ideal gross heating value of the equivalent hydrocarbon (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    <a class="code hl_struct" href="structxGrs.html">xGrs</a>.resize(4);</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <a class="code hl_struct" href="structxGrs.html">xGrs</a>[1] = 1 - x[2] - x[3];</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <a class="code hl_struct" href="structxGrs.html">xGrs</a>[2] = x[2];</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <a class="code hl_struct" href="structxGrs.html">xGrs</a>[3] = x[3];</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    HN = 0;</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <span class="keywordflow">for</span>(std::size_t i = 1; i &lt;= <a class="code hl_variable" href="Gross_8cpp.html#a9f33884b6f58c450cee327af3a17cc3a">NcGross</a>; ++i){</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        HN += x[i]*<a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[i];</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    }</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    HCH = 0;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structxGrs.html">xGrs</a>[1] &gt; 0){</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        HCH = HN / <a class="code hl_struct" href="structxGrs.html">xGrs</a>[1];</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    }</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>}</div>
</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span></div>
<div class="foldopen" id="foldopen00364" data-start="{" data-end="}">
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#aab13d9f5b32d4fe6789481b5edc7cb1e">  364</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#aab13d9f5b32d4fe6789481b5edc7cb1e">GrossInputs</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> T, <span class="keyword">const</span> <span class="keywordtype">double</span> P, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;x, std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keywordtype">double</span> &amp;Gr, <span class="keywordtype">double</span> &amp;HN, <span class="keywordtype">double</span> &amp;HCH, <span class="keywordtype">int</span> &amp;ierr, std::string &amp;herr)</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>{</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    <span class="comment">// Sub GrossInputs(T, P, x, xGrs, Gr, HN, HCH, ierr, herr)</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span> </div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    <span class="comment">// Calculate relative density and heating values based on composition.  This routine should only be used to get these</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    <span class="comment">//   two values for use as inputs to Method 1 or Method 2, and not for the relative density for any T and P.</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <span class="comment">//   All of the mole fractions in the mixture are required in this routine, not just xCH, xN2, and xCO2.</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    <span class="comment">// Inputs:</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    <span class="comment">//      T - Temperature (K), generally a reference temperature for relative density</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <span class="comment">//      P - Pressure (kPa), generally a reference pressure for relative density</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    <span class="comment">//      x - Molar compositions of all components in the mixture.  The order in this array is given at the top of this code.</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <span class="comment">// Outputs:</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    <span class="comment">//   xGrs - Compositions of the equivalent hydrocarbon, nitrogen, and CO2 (mole fractions)</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    <span class="comment">//     Gr - Relative density at T and P</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    <span class="comment">//     HN - Molar ideal gross heating value of the mixture (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    <span class="comment">//    HCH - Molar ideal gross heating value of the equivalent hydrocarbon (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    <span class="comment">//   ierr - Error number (0 indicates no error)</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="comment">//   herr - Error message if ierr is not equal to zero</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    <span class="keywordtype">double</span> Bref, Zref, Mref, Z, D, Mm;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    <a class="code hl_struct" href="structxGrs.html">xGrs</a>.resize(4);</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    ierr = 0;</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    herr = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    <a class="code hl_function" href="Gross_8cpp.html#a34daee09a7d0b0ed0c118b25ef565a6b">GrossHv</a>(x, <a class="code hl_struct" href="structxGrs.html">xGrs</a>, HN, HCH);</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    Bref = -0.12527 + 0.000591*T - 0.000000662*pow(T, 2);   <span class="comment">// 2nd virial coefficient of the reference fluid at T</span></div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    Zref = 1 + Bref*P/<a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>/T;                             <span class="comment">// Z of the reference fluid at T and P</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    Mref = 28.9625;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    <a class="code hl_function" href="Gross_8cpp.html#ae1798b648878f99010e0fb654a6b5590">MolarMassGross</a>(x, Mm);</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    <a class="code hl_function" href="Gross_8cpp.html#a738cf70144adce3acb490595d4bab51f">DensityGross</a>(T, P, <a class="code hl_struct" href="structxGrs.html">xGrs</a>, HCH, D, ierr, herr);           <span class="comment">// Density of the input fluid at T and D</span></div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    Z = P / T / D / <a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>;                                 <span class="comment">// Z of the input fluid at T and D</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    Gr = Mm * Zref / Mref / Z;</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>}</div>
</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span></div>
<div class="foldopen" id="foldopen00412" data-start="{" data-end="}">
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a957c10103f9962948a361b94ad63dda1">  412</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a957c10103f9962948a361b94ad63dda1">Bmix</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> T, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> HCH, <span class="keywordtype">double</span> &amp;B, <span class="keywordtype">double</span> &amp;C, <span class="keywordtype">int</span> &amp;ierr, std::string &amp;herr)</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>{</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    <span class="comment">// Sub Bmix(T, xGrs, HCH, B, C, ierr, herr)</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <span class="comment">// Calculate 2nd and 3rd virial coefficients for the mixture at T.</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span> </div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    <span class="comment">// Inputs:</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    <span class="comment">//      T - Temperature (K)</span></div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <span class="comment">//   xGrs - Compositions of the equivalent hydrocarbon, nitrogen, and CO2 (mole fractions)</span></div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    <span class="comment">//    HCH - Molar ideal gross heating value of the equivalent hydrocarbon (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span> </div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>    <span class="comment">// Outputs:</span></div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    <span class="comment">//      B - Second virial coefficient (dm^3/mol)</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    <span class="comment">//      C - Third virial coefficient (dm^6/mol^2)</span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <span class="comment">//   ierr - Error number (0 indicates no error)</span></div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    <span class="comment">//   herr - Error message if ierr is not equal to zero</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span> </div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    <span class="keywordtype">double</span> bCH[3], cCH[3], BB[4][4], CC[4][4][4];</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> onethrd = 1.0 / 3.0;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span> </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    ierr = 0;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    herr = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    B = 0;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    C = 0;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    <span class="comment">// Temperature dependent Bi and Ci values for obtaining B(CH-CH) and C(CH-CH-CH)</span></div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= 2; ++i){</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>        bCH[i] = <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[0][i] + <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[1][i]*T + <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[2][i]*pow(T, 2);</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>        cCH[i] = <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[0][i] + <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[1][i]*T + <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[2][i]*pow(T, 2);</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    }</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="comment">// Bij and Cijk values for nitrogen and CO2</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 2; i &lt;= 3; ++i){</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = i; j &lt;= 3; ++j){</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>            BB[i][j] = <a class="code hl_variable" href="Gross_8cpp.html#a458a3a52c606eb8634c3bd9a80458d19">b0</a>[i][j] + <a class="code hl_variable" href="Gross_8cpp.html#a7aef5ea4cd3449adb6c41acb4fe1ee22">b1</a>[i][j] * T + <a class="code hl_variable" href="Gross_8cpp.html#a9111038880f189f71b555792bb135149">b2</a>[i][j]*pow(T, 2);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = j; k &lt;= 3; ++k){</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>                CC[i][j][k] = <a class="code hl_variable" href="Gross_8cpp.html#a551f4167338c4bdf1e3c672d717d8387">c0</a>[i][j][k] + <a class="code hl_variable" href="Gross_8cpp.html#a50c04abf4d8d551ed2bc1fc79a8f711e">c1</a>[i][j][k] * T + <a class="code hl_variable" href="Gross_8cpp.html#a677b8fa6a606817e8087983862e45c5c">c2</a>[i][j][k]*pow(T, 2);</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>            }</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>        }</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    }</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span> </div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <span class="comment">// Bij values for use in calculating Bmix</span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    BB[1][1] = bCH[0] + bCH[1]*HCH + bCH[2]*pow(HCH, 2); <span class="comment">// B(CH-CH) for the equivalent hydrocarbon</span></div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    BB[1][2] = (0.72 + 0.00001875 * pow(320 - T, 2))*(BB[1][1] + BB[2][2])/2.0; <span class="comment">// B(CH-N2)</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <span class="keywordflow">if</span> (BB[1][1]*BB[3][3] &lt; 0){</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        ierr = 4; herr = <span class="stringliteral">&quot;Invalid input in Bmix routine&quot;</span>;</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    }</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    BB[1][3] = -0.865 * sqrt(BB[1][1] * BB[3][3]); <span class="comment">// B(CH-CO2)</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    <span class="comment">// Cijk values for use in calculating Cmix</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    CC[1][1][1] = cCH[0] + cCH[1] * HCH + cCH[2] * pow(HCH, 2); <span class="comment">// C(CH-CH-CH) for the equivalent hydrocarbon</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    <span class="keywordflow">if</span> (CC[1][1][1] &lt; 0 || CC[3][3][3] &lt; 0){</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        ierr = 5; herr = <span class="stringliteral">&quot;Invalid input in Bmix routine&quot;</span>;</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    }</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>    CC[1][1][2] = (0.92 + 0.0013 * (T - 270)) * pow(pow(CC[1][1][1], 2) * CC[2][2][2], onethrd); <span class="comment">// C(CH-CH-N2)</span></div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    CC[1][2][2] = (0.92 + 0.0013 * (T - 270)) * pow(pow(CC[2][2][2], 2) * CC[1][1][1], onethrd); <span class="comment">// C(CH-N2-N2)</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    CC[1][1][3] = 0.92 * pow(pow(CC[1][1][1], 2) * CC[3][3][3], onethrd); <span class="comment">// C(CH-CH-CO2)</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    CC[1][3][3] = 0.92 * pow(pow(CC[3][3][3], 2) * CC[1][1][1], onethrd); <span class="comment">// C(CH-CO2-CO2)</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    CC[1][2][3] = 1.1 * pow(CC[1][1][1] * CC[2][2][2] * CC[3][3][3], onethrd); <span class="comment">// C(CH-N2-CO2)</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span> </div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    <span class="comment">// Calculate Bmix and Cmix</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    <span class="keywordflow">for</span> (std::size_t i = 1; i &lt;= 3; ++i){</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <span class="keywordflow">for</span>(std::size_t j = i; j &lt;= 3; ++j){</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>            <span class="keywordflow">if</span> (i == j){</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>                B += BB[i][i]*pow(<a class="code hl_struct" href="structxGrs.html">xGrs</a>[i], 2);</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>            }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>                B += 2*BB[i][j]*<a class="code hl_struct" href="structxGrs.html">xGrs</a>[i]*<a class="code hl_struct" href="structxGrs.html">xGrs</a>[j];</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>            }</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>            <span class="keywordflow">for</span>(std::size_t k = j; k &lt;= 3; ++k){</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>                <span class="keywordflow">if</span> (i == j &amp;&amp; j == k) {</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>                    C += CC[i][i][i]*pow(<a class="code hl_struct" href="structxGrs.html">xGrs</a>[i], 3);</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>                }</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i != j &amp;&amp; j != k &amp;&amp; i != k){</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>                    C += 6*CC[i][j][k]*<a class="code hl_struct" href="structxGrs.html">xGrs</a>[i]*<a class="code hl_struct" href="structxGrs.html">xGrs</a>[j]*<a class="code hl_struct" href="structxGrs.html">xGrs</a>[k];</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>                }</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>                <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                    C += 3*CC[i][j][k]*<a class="code hl_struct" href="structxGrs.html">xGrs</a>[i]*<a class="code hl_struct" href="structxGrs.html">xGrs</a>[j]*<a class="code hl_struct" href="structxGrs.html">xGrs</a>[k];</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>                }</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>            }</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>        }</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    }</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>}</div>
</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span></div>
<div class="foldopen" id="foldopen00517" data-start="{" data-end="}">
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a78bf6b9b0be8f0ec35fc99177c1f691e">  517</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a78bf6b9b0be8f0ec35fc99177c1f691e">GrossMethod1</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> Th, <span class="keyword">const</span> <span class="keywordtype">double</span> Td, <span class="keyword">const</span> <span class="keywordtype">double</span> Pd, std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> Gr, <span class="keyword">const</span> <span class="keywordtype">double</span> Hv, <span class="keywordtype">double</span> &amp; Mm, <span class="keywordtype">double</span> &amp;HCH, <span class="keywordtype">double</span> &amp;HN, <span class="keywordtype">int</span> &amp;ierr, std::string &amp;herr)</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>{</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>    <span class="comment">// Sub GrossMethod1(Th, Td, Pd, xGrs, Gr, Hv, Mm, HCH, HN, ierr, herr)</span></div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>    <span class="comment">// Initialize variables required in the GROSS equation with Method 1 of the AGA 8 Part 1 publication.</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    <span class="comment">// Method 1 requires inputs of volumetric gross heating value, relative density, and mole fraction of CO2.</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>    <span class="comment">// </span></div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>    <span class="comment">// Inputs:</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    <span class="comment">//     Th - Reference temperature for heating value (K)</span></div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>    <span class="comment">//     Td - Reference temperature for density (K)</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>    <span class="comment">//     Pd - Reference pressure for density (kPa)</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>    <span class="comment">//   xGrs - Array of size 3 with the molar composition of CO2 in the 3rd position.  xCH and xN2 are returned in this array.</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    <span class="comment">//     Gr - Relative density at Td and Pd</span></div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>    <span class="comment">//     Hv - Volumetric ideal gross heating value (MJ/m^3) at Th</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    <span class="comment">// </span></div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>    <span class="comment">// Outputs:</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    <span class="comment">//   xGrs - Compositions of the equivalent hydrocarbon, nitrogen, and CO2 (mole fractions)</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>    <span class="comment">//     Mm - Molar mass (g/mol)</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    <span class="comment">//    HCH - Molar ideal gross heating value of the equivalent hydrocarbon (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>    <span class="comment">//     HN - Molar ideal gross heating value of the mixture (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    <span class="comment">//   ierr - Error number (0 indicates no error)</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>    <span class="comment">//   herr - Error message if ierr is not equal to zero</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span> </div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    <span class="keywordtype">double</span> xCH, xN2, xCO2, Zd, Zold, G1, G2, Bref, Zref, B, C;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    ierr = 0;</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    herr = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    <span class="keywordflow">if</span> (Gr &lt; <a class="code hl_variable" href="Detail_8cpp.html#ac29df3dcbefa1ce189e5990bde994025">epsilon</a>){ierr = 1; herr = <span class="stringliteral">&quot;Invalid input for relative density&quot;</span>; <span class="keywordflow">return</span>;}</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>    <span class="keywordflow">if</span> (Hv &lt; <a class="code hl_variable" href="Detail_8cpp.html#ac29df3dcbefa1ce189e5990bde994025">epsilon</a>){ierr = 2; herr = <span class="stringliteral">&quot;Invalid input for heating value&quot;</span>; <span class="keywordflow">return</span>;}</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>    xCO2 = <a class="code hl_struct" href="structxGrs.html">xGrs</a>[3];</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    Zd = 1;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>    G1 = -2.709328;</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    G2 = 0.021062199;</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    Bref = -0.12527 + 0.000591*Td - 0.000000662*pow(Td, 2);              <span class="comment">// [dm^3/mol]</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    Zref = (1 + Pd / <a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a> / Td * Bref);</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 20; ++i){</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>        Zold = Zd;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>        HN = Zd*<a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>*Td/Pd*Hv*(1 + 0.0001027*(Th - 298.15));          <span class="comment">// [kJ/mol] at 25 C</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>        Mm = Gr*Zd*28.9625 / Zref;                                     <span class="comment">// [g/mol]</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>        xCH = (Mm + (xCO2 - 1) * <a class="code hl_variable" href="Gross_8cpp.html#a418bd4a5071b601ba760a723a64201fe">mN2</a> - xCO2 * <a class="code hl_variable" href="Gross_8cpp.html#a91d30f8476b8687ca8b7e800926abc7c">mCO2</a> - G2 * HN) / (G1 - <a class="code hl_variable" href="Gross_8cpp.html#a418bd4a5071b601ba760a723a64201fe">mN2</a>);</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>        xN2 = 1 - xCH - xCO2;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>        <span class="keywordflow">if</span> (xN2 &lt; 0){</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>            ierr = 3; herr = <span class="stringliteral">&quot;Negative nitrogen value in GROSS method 1 setup&quot;</span>;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>        }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>        HCH = HN / xCH;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>        <a class="code hl_struct" href="structxGrs.html">xGrs</a>[1] = xCH;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>        <a class="code hl_struct" href="structxGrs.html">xGrs</a>[2] = xN2;</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>        <a class="code hl_function" href="Gross_8cpp.html#a957c10103f9962948a361b94ad63dda1">Bmix</a>(Td, <a class="code hl_struct" href="structxGrs.html">xGrs</a>, HCH, B, C, ierr, herr);</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>        <span class="keywordflow">if</span> (ierr &gt; 0){</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        } </div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        Zd = 1 + B*Pd/<a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a>/Td;</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        <span class="keywordflow">if</span>(std::abs(Zold - Zd) &lt; 0.0000001) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>    }</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>}</div>
</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span></div>
<div class="foldopen" id="foldopen00594" data-start="{" data-end="}">
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a6a0fa1a89eb0fcc02b18d047635ae896">  594</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a6a0fa1a89eb0fcc02b18d047635ae896">GrossMethod2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> Th, <span class="keyword">const</span> <span class="keywordtype">double</span> Td, <span class="keyword">const</span> <span class="keywordtype">double</span> Pd, std::vector&lt;double&gt; &amp;<a class="code hl_struct" href="structxGrs.html">xGrs</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> Gr, <span class="keywordtype">double</span> &amp;Hv, <span class="keywordtype">double</span> &amp;Mm, <span class="keywordtype">double</span> &amp;HCH, <span class="keywordtype">double</span> &amp;HN, <span class="keywordtype">int</span> &amp;ierr, std::string &amp;herr)</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>{</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    <span class="comment">// Sub GrossMethod2(Th, Td, Pd, xGrs, Gr, Hv, Mm, HCH, HN, ierr, herr)</span></div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span> </div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>    <span class="comment">// Initialize variables required in the GROSS equation with Method 2 of the AGA 8 Part 1 publication.</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>    <span class="comment">// Method 2 requires inputs of relative density and mole fractions of nitrogen and CO2.</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>    <span class="comment">// </span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    <span class="comment">// Inputs:</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    <span class="comment">//     Th - Reference temperature for heating value (K)</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>    <span class="comment">//     Td - Reference temperature for density (K)</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>    <span class="comment">//     Pd - Reference pressure for density (kPa)</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    <span class="comment">//   xGrs - Array of size 3 with the molar composition of N2 in the 2nd position and CO2 in the 3rd position.  xCH is returned in this array.</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    <span class="comment">//     Gr - Relative density at Td and Pd</span></div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    <span class="comment">// </span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    <span class="comment">// Outputs:</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    <span class="comment">//   xGrs - Compositions of the equivalent hydrocarbon, nitrogen, and CO2 (mole fractions)</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>    <span class="comment">//     Hv - Volumetric ideal gross heating value (MJ/m^3) at Th</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    <span class="comment">//     Mm - Molar mass (g/mol)</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    <span class="comment">//    HCH - Molar ideal gross heating value of the equivalent hydrocarbon (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>    <span class="comment">//     HN - Molar ideal gross heating value of the mixture (kJ/mol) at 298.15 K</span></div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    <span class="comment">//   ierr - Error number (0 indicates no error)</span></div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>    <span class="comment">//   herr - Error message if ierr is not equal to zero</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span> </div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    <span class="keywordtype">double</span> xCH, Z, Zold, Bref, Zref, MrCH, G1, G2, B, C, xN2, xCO2;</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>    ierr = 0;</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>    herr = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>    <span class="keywordflow">if</span> (Gr &lt; <a class="code hl_variable" href="Detail_8cpp.html#ac29df3dcbefa1ce189e5990bde994025">epsilon</a>){ ierr = 1; herr = <span class="stringliteral">&quot;Invalid input for relative density&quot;</span>; <span class="keywordflow">return</span>; }</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>    xN2 = <a class="code hl_struct" href="structxGrs.html">xGrs</a>[2];</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    xCO2 = <a class="code hl_struct" href="structxGrs.html">xGrs</a>[3];</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>    xCH = 1 - xN2 - xCO2;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>    <a class="code hl_struct" href="structxGrs.html">xGrs</a>[1] = xCH;</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    Z = 1;</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>    G1 = -2.709328;</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    G2 = 0.021062199;</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>    Bref = -0.12527 + 0.000591*Td - 0.000000662*pow(Td, 2);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>    Zref = (1 + Pd / <a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a> / Td * Bref);</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 20; ++i){</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        Zold = Z;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>        Mm = Gr*Z*28.9625/Zref;</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        MrCH = (Mm - xN2 * <a class="code hl_variable" href="Gross_8cpp.html#a418bd4a5071b601ba760a723a64201fe">mN2</a> - xCO2 * <a class="code hl_variable" href="Gross_8cpp.html#a91d30f8476b8687ca8b7e800926abc7c">mCO2</a>)/xCH;</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>        HCH = (MrCH - G1) / G2;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        <a class="code hl_function" href="Gross_8cpp.html#a957c10103f9962948a361b94ad63dda1">Bmix</a>(Td, <a class="code hl_struct" href="structxGrs.html">xGrs</a>, HCH, B, C, ierr, herr);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>        <span class="keywordflow">if</span> (ierr &gt; 0){ <span class="keywordflow">return</span>; }</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        Z = 1 + B * Pd / <a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a> / Td;</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>        <span class="keywordflow">if</span> (std::abs(Zold - Z) &lt; 0.0000001){ <span class="keywordflow">break</span>; };</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>    }</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>    HN = HCH * xCH;</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>    Hv = HN / Z / <a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a> / Td * Pd / (1 + 0.0001027 * (Th - 298.15));</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>}</div>
</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span></div>
<div class="foldopen" id="foldopen00651" data-start="{" data-end="}">
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno"><a class="line" href="Gross_8cpp.html#a823e84884715c2fa0ba5ccbc9f6761b7">  651</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Gross_8cpp.html#a823e84884715c2fa0ba5ccbc9f6761b7">SetupGross</a>()</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>{</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>  <span class="comment">// Initialize all the constants and parameters in the GROSS model.</span></div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>  <a class="code hl_variable" href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a> = 8.31451;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span> </div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>  <span class="comment">// Molar masses (g/mol).  These are the same as those in the DETAIL method.</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[1] = 16.043;    <span class="comment">// Methane</span></div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[2] = 28.0135;   <span class="comment">// Nitrogen</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[3] = 44.01;     <span class="comment">// Carbon dioxide</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[4] = 30.07;     <span class="comment">// Ethane</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[5] = 44.097;    <span class="comment">// Propane</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[6] = 58.123;    <span class="comment">// Isobutane</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[7] = 58.123;    <span class="comment">// n-Butane</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[8] = 72.15;     <span class="comment">// Isopentane</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[9] = 72.15;     <span class="comment">// n-Pentane</span></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[10] = 86.177;   <span class="comment">// Hexane</span></div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[11] = 100.204;  <span class="comment">// Heptane</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[12] = 114.231;  <span class="comment">// Octane</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[13] = 128.258;  <span class="comment">// Nonane</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[14] = 142.285;  <span class="comment">// Decane</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[15] = 2.0159;   <span class="comment">// Hydrogen</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[16] = 31.9988;  <span class="comment">// Oxygen</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[17] = 28.01;    <span class="comment">// Carbon monoxide</span></div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[18] = 18.0153;  <span class="comment">// Water</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[19] = 34.082;   <span class="comment">// Hydrogen sulfide</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[20] = 4.0026;   <span class="comment">// Helium</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>  <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[21] = 39.948;   <span class="comment">// Argon</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>  <span class="comment">//Initialize constants</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>  <a class="code hl_variable" href="Gross_8cpp.html#a458a3a52c606eb8634c3bd9a80458d19">b0</a>[2][2] = -0.1446;           <a class="code hl_variable" href="Gross_8cpp.html#a7aef5ea4cd3449adb6c41acb4fe1ee22">b1</a>[2][2] = 0.00074091;         <a class="code hl_variable" href="Gross_8cpp.html#a9111038880f189f71b555792bb135149">b2</a>[2][2] = -0.00000091195;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>  <a class="code hl_variable" href="Gross_8cpp.html#a458a3a52c606eb8634c3bd9a80458d19">b0</a>[2][3] = -0.339693;         <a class="code hl_variable" href="Gross_8cpp.html#a7aef5ea4cd3449adb6c41acb4fe1ee22">b1</a>[2][3] = 0.00161176;         <a class="code hl_variable" href="Gross_8cpp.html#a9111038880f189f71b555792bb135149">b2</a>[2][3] = -0.00000204429;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>  <a class="code hl_variable" href="Gross_8cpp.html#a458a3a52c606eb8634c3bd9a80458d19">b0</a>[3][3] = -0.86834;          <a class="code hl_variable" href="Gross_8cpp.html#a7aef5ea4cd3449adb6c41acb4fe1ee22">b1</a>[3][3] = 0.0040376;          <a class="code hl_variable" href="Gross_8cpp.html#a9111038880f189f71b555792bb135149">b2</a>[3][3] = -0.0000051657;</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>  <a class="code hl_variable" href="Gross_8cpp.html#a551f4167338c4bdf1e3c672d717d8387">c0</a>[2][2][2] = 0.0078498;      <a class="code hl_variable" href="Gross_8cpp.html#a50c04abf4d8d551ed2bc1fc79a8f711e">c1</a>[2][2][2] = -0.000039895;    <a class="code hl_variable" href="Gross_8cpp.html#a677b8fa6a606817e8087983862e45c5c">c2</a>[2][2][2] = 0.000000061187;</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>  <a class="code hl_variable" href="Gross_8cpp.html#a551f4167338c4bdf1e3c672d717d8387">c0</a>[2][2][3] = 0.00552066;     <a class="code hl_variable" href="Gross_8cpp.html#a50c04abf4d8d551ed2bc1fc79a8f711e">c1</a>[2][2][3] = -0.0000168609;   <a class="code hl_variable" href="Gross_8cpp.html#a677b8fa6a606817e8087983862e45c5c">c2</a>[2][2][3] = 0.0000000157169;</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>  <a class="code hl_variable" href="Gross_8cpp.html#a551f4167338c4bdf1e3c672d717d8387">c0</a>[2][3][3] = 0.00358783;     <a class="code hl_variable" href="Gross_8cpp.html#a50c04abf4d8d551ed2bc1fc79a8f711e">c1</a>[2][3][3] = 0.00000806674;   <a class="code hl_variable" href="Gross_8cpp.html#a677b8fa6a606817e8087983862e45c5c">c2</a>[2][3][3] = -0.0000000325798;</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>  <a class="code hl_variable" href="Gross_8cpp.html#a551f4167338c4bdf1e3c672d717d8387">c0</a>[3][3][3] = 0.0020513;      <a class="code hl_variable" href="Gross_8cpp.html#a50c04abf4d8d551ed2bc1fc79a8f711e">c1</a>[3][3][3] = 0.000034888;     <a class="code hl_variable" href="Gross_8cpp.html#a677b8fa6a606817e8087983862e45c5c">c2</a>[3][3][3] = -0.000000083703;</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>  <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[0][0] = -0.425468;       <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[1][0] = 0.002865;         <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[2][0] = -0.00000462073;</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>  <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[0][1] = 0.000877118;     <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[1][1] = -0.00000556281;   <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[2][1] = 0.0000000088151;</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>  <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[0][2] = -0.000000824747; <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[1][2] = 0.00000000431436; <a class="code hl_variable" href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a>[2][2] = -6.08319E-12;</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>  <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[0][0] = -0.302488;       <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[1][0] = 0.00195861;       <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[2][0] = -0.00000316302;</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>  <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[0][1] = 0.000646422;     <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[1][1] = -0.00000422876;   <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[2][1] = 0.00000000688157;</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>  <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[0][2] = -0.000000332805; <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[1][2] = 0.0000000022316;  <a class="code hl_variable" href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a>[2][2] = -3.67713E-12;</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>  <span class="comment">// //Heating values from ISO 6976 at 25 C (kJ/mol)</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  <span class="comment">// &#39;xHN(1) = 890.58    &#39;Methane</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  <span class="comment">// &#39;xHN(2) = 0         &#39;Nitrogen</span></div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  <span class="comment">// &#39;xHN(3) = 0         &#39;Carbon dioxide</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  <span class="comment">// &#39;xHN(4) = 1560.69   &#39;Ethane</span></div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>  <span class="comment">// &#39;xHN(5) = 2219.17   &#39;Propane</span></div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  <span class="comment">// &#39;xHN(6) = 2868.2    &#39;Isobutane</span></div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>  <span class="comment">// &#39;xHN(7) = 2877.4    &#39;n-Butane</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>  <span class="comment">// &#39;xHN(8) = 3528.83   &#39;Isopentane</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>  <span class="comment">// &#39;xHN(9) = 3535.77   &#39;n-Pentane</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>  <span class="comment">// &#39;xHN(10) = 4194.95  &#39;Hexane</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>  <span class="comment">// &#39;xHN(11) = 4853.43  &#39;Heptane</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>  <span class="comment">// &#39;xHN(12) = 5511.8   &#39;Octane</span></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>  <span class="comment">// &#39;xHN(13) = 6171.15  &#39;Nonane</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>  <span class="comment">// &#39;xHN(14) = 6829.77  &#39;Decane</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>  <span class="comment">// &#39;xHN(15) = 285.83   &#39;Hydrogen</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>  <span class="comment">// &#39;xHN(16) = 0        &#39;Oxygen</span></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>  <span class="comment">// &#39;xHN(17) = 282.98   &#39;Carbon monoxide</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>  <span class="comment">// &#39;xHN(18) = 44.013   &#39;Water</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>  <span class="comment">// &#39;xHN(19) = 562.01   &#39;Hydrogen sulfide</span></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>  <span class="comment">// &#39;xHN(20) = 0        &#39;Helium</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>  <span class="comment">// &#39;xHN(21) = 0        &#39;Argon</span></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span> </div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>  <span class="comment">// Heating values from AGA-5, 2009 at 25 C (kJ/mol)</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[1] = 890.63;     <span class="comment">// Methane</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[2] = 0;          <span class="comment">// Nitrogen</span></div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[3] = 0;          <span class="comment">// Carbon dioxide</span></div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[4] = 1560.69;    <span class="comment">// Ethane</span></div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[5] = 2219.17;    <span class="comment">// Propane</span></div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[6] = 2868.2;     <span class="comment">// Isobutane</span></div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[7] = 2877.4;     <span class="comment">// n-Butane</span></div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[8] = 3528.83;    <span class="comment">// Isopentane</span></div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[9] = 3535.77;    <span class="comment">// n-Pentane</span></div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[10] = 4194.95;   <span class="comment">// Hexane</span></div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[11] = 4853.43;   <span class="comment">// Heptane</span></div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[12] = 5511.8;    <span class="comment">// Octane</span></div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[13] = 6171.15;   <span class="comment">// Nonane</span></div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[14] = 6829.77;   <span class="comment">// Decane</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[15] = 285.83;    <span class="comment">// Hydrogen</span></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[16] = 0;         <span class="comment">// Oxygen</span></div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[17] = 282.98;    <span class="comment">// Carbon monoxide</span></div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[18] = 44.016;    <span class="comment">// Water</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[19] = 562.01;    <span class="comment">// Hydrogen sulfide</span></div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[20] = 0;         <span class="comment">// Helium</span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>  <a class="code hl_variable" href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a>[21] = 0;         <span class="comment">// Argon</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span> </div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>  <a class="code hl_variable" href="Gross_8cpp.html#a418bd4a5071b601ba760a723a64201fe">mN2</a> = <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[2];</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>  <a class="code hl_variable" href="Gross_8cpp.html#a91d30f8476b8687ca8b7e800926abc7c">mCO2</a> = <a class="code hl_variable" href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a>[3];</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>}</div>
</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span> </div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span> </div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span> </div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span><span class="preprocessor">#ifdef TEST_GROSS</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span><span class="keywordtype">int</span> main(){</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>    <a class="code hl_function" href="Gross_8cpp.html#a823e84884715c2fa0ba5ccbc9f6761b7">SetupGross</a>();</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>    <span class="keywordtype">double</span> _x[] = {0.77824, 0.02, 0.06, 0.08, 0.03, 0.0015, 0.003, 0.0005, 0.00165, 0.00215, 0.00088, 0.00024, 0.00015, 0.00009, 0.004, 0.005, 0.002, 0.0001, 0.0025, 0.007, 0.001};</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>    std::vector&lt;double&gt; x(_x, _x+<a class="code hl_variable" href="Gross_8cpp.html#a9f33884b6f58c450cee327af3a17cc3a">NcGross</a>), <a class="code hl_struct" href="structxGrs.html">xGrs</a>(4,0);</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>    x.insert(x.begin(), 0.0);</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>    </div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>    <span class="keywordtype">double</span> mm = 0;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>    <a class="code hl_function" href="Gross_8cpp.html#ae1798b648878f99010e0fb654a6b5590">MolarMassGross</a>(x, mm);</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span> </div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    std::string herr;</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span> </div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>    <span class="keywordtype">double</span> T = 300, P = 10000, Td = 273.15, Th = 298.15, Pd = 101.325, D = 6.35826, pp = -1, Hv = -1, Hv2 = -1, Gr, HN, HCH, Z=-1;</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    printf(<span class="stringliteral">&quot;Inputs-----\n&quot;</span>);</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>    printf(<span class="stringliteral">&quot;Temperature [K]:                    300.0000000000000 != %0.16g\n&quot;</span>,T);</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    printf(<span class="stringliteral">&quot;Pressure [kPa]:                     10000.00000000000 != %0.16g\n&quot;</span>,P);</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    printf(<span class="stringliteral">&quot;Th [K]:                             298.1500000000000 != %0.16g\n&quot;</span>,Th);</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    printf(<span class="stringliteral">&quot;Td [K]:                             273.1500000000000 != %0.16g\n&quot;</span>,Td);</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    printf(<span class="stringliteral">&quot;Pd [kPa]:                           101.3250000000000 != %0.16g\n&quot;</span>,Pd);</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    <a class="code hl_function" href="Gross_8cpp.html#a34daee09a7d0b0ed0c118b25ef565a6b">GrossHv</a>(x,<a class="code hl_struct" href="structxGrs.html">xGrs</a>,HN,HCH);</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    <a class="code hl_function" href="Gross_8cpp.html#a738cf70144adce3acb490595d4bab51f">DensityGross</a>(T,P,<a class="code hl_struct" href="structxGrs.html">xGrs</a>,HCH,D,ierr,herr);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>    <a class="code hl_function" href="Gross_8cpp.html#a789a45b2ee42f8b3ceeb66df81b1ce0c">PressureGross</a>(T,D,<a class="code hl_struct" href="structxGrs.html">xGrs</a>,HCH,pp,Z,ierr,herr);</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>    printf(<span class="stringliteral">&quot;Outputs-----\n&quot;</span>);</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>    printf(<span class="stringliteral">&quot;Molar mass [g/mol]:                 20.54333051000000 != %0.16g\n&quot;</span>,mm);</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>    printf(<span class="stringliteral">&quot;Molar density [mol/l]:              5.117641317088482 != %0.16g\n&quot;</span>,D);</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    printf(<span class="stringliteral">&quot;Pressure [kPa]:                     9999.999999999998 != %0.16g\n&quot;</span>,P);</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>    printf(<span class="stringliteral">&quot;Compressibility factor:             0.7833795701012788 != %0.16g\n&quot;</span>,Z);</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>    <a class="code hl_function" href="Gross_8cpp.html#aab13d9f5b32d4fe6789481b5edc7cb1e">GrossInputs</a>(Td, Pd, x, <a class="code hl_struct" href="structxGrs.html">xGrs</a>, Gr, HN, HCH, ierr, herr);</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>    <a class="code hl_function" href="Gross_8cpp.html#a34daee09a7d0b0ed0c118b25ef565a6b">GrossHv</a>(x,<a class="code hl_struct" href="structxGrs.html">xGrs</a>,HN,HCH);</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>    <a class="code hl_function" href="Gross_8cpp.html#a738cf70144adce3acb490595d4bab51f">DensityGross</a>(Td,Pd,<a class="code hl_struct" href="structxGrs.html">xGrs</a>,HCH,D,ierr,herr);</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>    Hv = HN*D;</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>    printf(<span class="stringliteral">&quot;Relative density:                   0.7112387718599272 != %0.16g\n&quot;</span>,Gr);</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>    printf(<span class="stringliteral">&quot;Molar heating value (kJ/mol, 25 C): 924.3591780000000 != %0.16g\n&quot;</span>, HN);</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>    printf(<span class="stringliteral">&quot;HCH (kJ/mol, 25 C):                 1004.738236956522 != %0.16g\n&quot;</span>,HCH);</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>    printf(<span class="stringliteral">&quot;Equivalent hydrocarbon fraction:    0.9199999999999999 != %0.16g\n&quot;</span>,<a class="code hl_struct" href="structxGrs.html">xGrs</a>[1]);</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>    printf(<span class="stringliteral">&quot;nitrogen mole fraction:             2.000000000000000E-02 != %0.16g\n&quot;</span>,<a class="code hl_struct" href="structxGrs.html">xGrs</a>[2]);</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>    printf(<span class="stringliteral">&quot;CO2 mole fraction:                  6.000000000000000E-02 != %0.16g\n&quot;</span>,<a class="code hl_struct" href="structxGrs.html">xGrs</a>[3]);</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>    printf(<span class="stringliteral">&quot;Volumetric heating value at Td,Pd:  41.37676728724603 != %0.16g\n&quot;</span>,Hv);</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span> </div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>    <a class="code hl_struct" href="structxGrs.html">xGrs</a>[2] = x[2];</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>    <a class="code hl_struct" href="structxGrs.html">xGrs</a>[3] = x[3];</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    <a class="code hl_function" href="Gross_8cpp.html#a6a0fa1a89eb0fcc02b18d047635ae896">GrossMethod2</a>(Th, Td, Pd, <a class="code hl_struct" href="structxGrs.html">xGrs</a>, Gr, Hv2, mm, HCH, HN, ierr, herr);</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>    <a class="code hl_function" href="Gross_8cpp.html#a738cf70144adce3acb490595d4bab51f">DensityGross</a>(T,P,<a class="code hl_struct" href="structxGrs.html">xGrs</a>,HCH,D,ierr,herr);</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>    printf(<span class="stringliteral">&quot;Gross method 2-----\n&quot;</span>);</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>    printf(<span class="stringliteral">&quot;Molar density [mol/l]:              5.197833636353455 != %0.16g\n&quot;</span>, D);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>    printf(<span class="stringliteral">&quot;Volumetric heating value at Td,Pd:  42.15440903329388 != %0.16g\n&quot;</span>, Hv2);</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span> </div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>    <a class="code hl_struct" href="structxGrs.html">xGrs</a>[2] = x[2];</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>    <a class="code hl_struct" href="structxGrs.html">xGrs</a>[3] = x[3];</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>    <a class="code hl_function" href="Gross_8cpp.html#a78bf6b9b0be8f0ec35fc99177c1f691e">GrossMethod1</a>(Th,Td,Pd,<a class="code hl_struct" href="structxGrs.html">xGrs</a>,Gr,Hv,mm,HCH,HN,ierr,herr);</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    <a class="code hl_function" href="Gross_8cpp.html#a738cf70144adce3acb490595d4bab51f">DensityGross</a>(T,P,<a class="code hl_struct" href="structxGrs.html">xGrs</a>,HCH,D,ierr,herr);</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>    printf(<span class="stringliteral">&quot;Gross method 1-----\n&quot;</span>);</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    printf(<span class="stringliteral">&quot;Molar density [mol/l]:              5.144374668159809 != %0.16g\n&quot;</span>, D);</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>}</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aDetail_8cpp_html_a31983b0d2f1ecdbb8aeb2a5280c579bb"><div class="ttname"><a href="Detail_8cpp.html#a31983b0d2f1ecdbb8aeb2a5280c579bb">MaxFlds</a></div><div class="ttdeci">static const int MaxFlds</div><div class="ttdef"><b>Definition</b> <a href="Detail_8cpp_source.html#l00128">Detail.cpp:128</a></div></div>
<div class="ttc" id="aDetail_8cpp_html_ac29df3dcbefa1ce189e5990bde994025"><div class="ttname"><a href="Detail_8cpp.html#ac29df3dcbefa1ce189e5990bde994025">epsilon</a></div><div class="ttdeci">static const double epsilon</div><div class="ttdef"><b>Definition</b> <a href="Detail_8cpp_source.html#l00129">Detail.cpp:129</a></div></div>
<div class="ttc" id="aDetail_8cpp_html_ac781385d6450b283663de0cf6d4253b7"><div class="ttname"><a href="Detail_8cpp.html#ac781385d6450b283663de0cf6d4253b7">dPdDsave</a></div><div class="ttdeci">static double dPdDsave</div><div class="ttdef"><b>Definition</b> <a href="Detail_8cpp_source.html#l00140">Detail.cpp:140</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a34daee09a7d0b0ed0c118b25ef565a6b"><div class="ttname"><a href="Gross_8cpp.html#a34daee09a7d0b0ed0c118b25ef565a6b">GrossHv</a></div><div class="ttdeci">void GrossHv(const std::vector&lt; double &gt; &amp;x, std::vector&lt; double &gt; &amp;xGrs, double &amp;HN, double &amp;HCH)</div><div class="ttdoc">Calculate ideal heating values based on composition.</div><div class="ttdef"><b>Definition</b> <a href="#l00317">Gross.cpp:317</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a36ad4d1da6094b88ad6ca877f9b6f88d"><div class="ttname"><a href="Gross_8cpp.html#a36ad4d1da6094b88ad6ca877f9b6f88d">RGross</a></div><div class="ttdeci">static double RGross</div><div class="ttdef"><b>Definition</b> <a href="#l00125">Gross.cpp:125</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a418bd4a5071b601ba760a723a64201fe"><div class="ttname"><a href="Gross_8cpp.html#a418bd4a5071b601ba760a723a64201fe">mN2</a></div><div class="ttdeci">static double mN2</div><div class="ttdef"><b>Definition</b> <a href="#l00128">Gross.cpp:128</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a458a3a52c606eb8634c3bd9a80458d19"><div class="ttname"><a href="Gross_8cpp.html#a458a3a52c606eb8634c3bd9a80458d19">b0</a></div><div class="ttdeci">static double b0[4][4]</div><div class="ttdef"><b>Definition</b> <a href="#l00130">Gross.cpp:130</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a50c04abf4d8d551ed2bc1fc79a8f711e"><div class="ttname"><a href="Gross_8cpp.html#a50c04abf4d8d551ed2bc1fc79a8f711e">c1</a></div><div class="ttdeci">static double c1[4][4][4]</div><div class="ttdef"><b>Definition</b> <a href="#l00131">Gross.cpp:131</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a551f4167338c4bdf1e3c672d717d8387"><div class="ttname"><a href="Gross_8cpp.html#a551f4167338c4bdf1e3c672d717d8387">c0</a></div><div class="ttdeci">static double c0[4][4][4]</div><div class="ttdef"><b>Definition</b> <a href="#l00131">Gross.cpp:131</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a64befef7a7890997c9073a23f52d31b3"><div class="ttname"><a href="Gross_8cpp.html#a64befef7a7890997c9073a23f52d31b3">bCHx</a></div><div class="ttdeci">static double bCHx[3][3]</div><div class="ttdef"><b>Definition</b> <a href="#l00130">Gross.cpp:130</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a677b8fa6a606817e8087983862e45c5c"><div class="ttname"><a href="Gross_8cpp.html#a677b8fa6a606817e8087983862e45c5c">c2</a></div><div class="ttdeci">static double c2[4][4][4]</div><div class="ttdef"><b>Definition</b> <a href="#l00131">Gross.cpp:131</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a6a0fa1a89eb0fcc02b18d047635ae896"><div class="ttname"><a href="Gross_8cpp.html#a6a0fa1a89eb0fcc02b18d047635ae896">GrossMethod2</a></div><div class="ttdeci">void GrossMethod2(const double Th, const double Td, const double Pd, std::vector&lt; double &gt; &amp;xGrs, const double Gr, double &amp;Hv, double &amp;Mm, double &amp;HCH, double &amp;HN, int &amp;ierr, std::string &amp;herr)</div><div class="ttdoc">Initialize variables required in the GROSS equation with Method 2 of the AGA 8 Part 1 publication.</div><div class="ttdef"><b>Definition</b> <a href="#l00594">Gross.cpp:594</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a71bf090bfa8699be83c8c454edb2f7c0"><div class="ttname"><a href="Gross_8cpp.html#a71bf090bfa8699be83c8c454edb2f7c0">xHN</a></div><div class="ttdeci">static double xHN[MaxFlds+1]</div><div class="ttdef"><b>Definition</b> <a href="#l00129">Gross.cpp:129</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a738cf70144adce3acb490595d4bab51f"><div class="ttname"><a href="Gross_8cpp.html#a738cf70144adce3acb490595d4bab51f">DensityGross</a></div><div class="ttdeci">void DensityGross(const double T, const double P, const std::vector&lt; double &gt; &amp;xGrs, const double HCH, double &amp;D, int &amp;ierr, std::string &amp;herr)</div><div class="ttdoc">Calculate density as a function of temperature and pressure.</div><div class="ttdef"><b>Definition</b> <a href="#l00236">Gross.cpp:236</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a789a45b2ee42f8b3ceeb66df81b1ce0c"><div class="ttname"><a href="Gross_8cpp.html#a789a45b2ee42f8b3ceeb66df81b1ce0c">PressureGross</a></div><div class="ttdeci">void PressureGross(const double T, const double D, const std::vector&lt; double &gt; &amp;xGrs, const double HCH, double &amp;P, double &amp;Z, int &amp;ierr, std::string &amp;herr)</div><div class="ttdoc">Calculate pressure as a function of temperature and density.</div><div class="ttdef"><b>Definition</b> <a href="#l00183">Gross.cpp:183</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a78bf6b9b0be8f0ec35fc99177c1f691e"><div class="ttname"><a href="Gross_8cpp.html#a78bf6b9b0be8f0ec35fc99177c1f691e">GrossMethod1</a></div><div class="ttdeci">void GrossMethod1(const double Th, const double Td, const double Pd, std::vector&lt; double &gt; &amp;xGrs, const double Gr, const double Hv, double &amp;Mm, double &amp;HCH, double &amp;HN, int &amp;ierr, std::string &amp;herr)</div><div class="ttdoc">Initialize variables required in the GROSS equation with Method 1 of the AGA 8 Part 1 publication.</div><div class="ttdef"><b>Definition</b> <a href="#l00517">Gross.cpp:517</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a7aef5ea4cd3449adb6c41acb4fe1ee22"><div class="ttname"><a href="Gross_8cpp.html#a7aef5ea4cd3449adb6c41acb4fe1ee22">b1</a></div><div class="ttdeci">static double b1[4][4]</div><div class="ttdef"><b>Definition</b> <a href="#l00130">Gross.cpp:130</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a823e84884715c2fa0ba5ccbc9f6761b7"><div class="ttname"><a href="Gross_8cpp.html#a823e84884715c2fa0ba5ccbc9f6761b7">SetupGross</a></div><div class="ttdeci">void SetupGross()</div><div class="ttdoc">Initialize all the constants and parameters in the GROSS model.</div><div class="ttdef"><b>Definition</b> <a href="#l00651">Gross.cpp:651</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a9111038880f189f71b555792bb135149"><div class="ttname"><a href="Gross_8cpp.html#a9111038880f189f71b555792bb135149">b2</a></div><div class="ttdeci">static double b2[4][4]</div><div class="ttdef"><b>Definition</b> <a href="#l00130">Gross.cpp:130</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a91d30f8476b8687ca8b7e800926abc7c"><div class="ttname"><a href="Gross_8cpp.html#a91d30f8476b8687ca8b7e800926abc7c">mCO2</a></div><div class="ttdeci">static double mCO2</div><div class="ttdef"><b>Definition</b> <a href="#l00128">Gross.cpp:128</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a93ff4c0c557e4d489115803079f33245"><div class="ttname"><a href="Gross_8cpp.html#a93ff4c0c557e4d489115803079f33245">MMiGross</a></div><div class="ttdeci">static double MMiGross[MaxFlds+1]</div><div class="ttdef"><b>Definition</b> <a href="#l00129">Gross.cpp:129</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a957c10103f9962948a361b94ad63dda1"><div class="ttname"><a href="Gross_8cpp.html#a957c10103f9962948a361b94ad63dda1">Bmix</a></div><div class="ttdeci">void Bmix(const double T, const std::vector&lt; double &gt; &amp;xGrs, const double HCH, double &amp;B, double &amp;C, int &amp;ierr, std::string &amp;herr)</div><div class="ttdoc">Calculate 2nd and 3rd virial coefficients for the mixture at T.</div><div class="ttdef"><b>Definition</b> <a href="#l00412">Gross.cpp:412</a></div></div>
<div class="ttc" id="aGross_8cpp_html_a9f33884b6f58c450cee327af3a17cc3a"><div class="ttname"><a href="Gross_8cpp.html#a9f33884b6f58c450cee327af3a17cc3a">NcGross</a></div><div class="ttdeci">static const int NcGross</div><div class="ttdef"><b>Definition</b> <a href="#l00126">Gross.cpp:126</a></div></div>
<div class="ttc" id="aGross_8cpp_html_aab13d9f5b32d4fe6789481b5edc7cb1e"><div class="ttname"><a href="Gross_8cpp.html#aab13d9f5b32d4fe6789481b5edc7cb1e">GrossInputs</a></div><div class="ttdeci">void GrossInputs(const double T, const double P, const std::vector&lt; double &gt; &amp;x, std::vector&lt; double &gt; &amp;xGrs, double &amp;Gr, double &amp;HN, double &amp;HCH, int &amp;ierr, std::string &amp;herr)</div><div class="ttdoc">Calculate relative density and heating values based on composition.</div><div class="ttdef"><b>Definition</b> <a href="#l00364">Gross.cpp:364</a></div></div>
<div class="ttc" id="aGross_8cpp_html_ad3272da6cc31e28dc66f2f7ffe1e47cc"><div class="ttname"><a href="Gross_8cpp.html#ad3272da6cc31e28dc66f2f7ffe1e47cc">cCHx</a></div><div class="ttdeci">static double cCHx[3][3]</div><div class="ttdef"><b>Definition</b> <a href="#l00130">Gross.cpp:130</a></div></div>
<div class="ttc" id="aGross_8cpp_html_ae1798b648878f99010e0fb654a6b5590"><div class="ttname"><a href="Gross_8cpp.html#ae1798b648878f99010e0fb654a6b5590">MolarMassGross</a></div><div class="ttdeci">void MolarMassGross(const std::vector&lt; double &gt; &amp;x, double &amp;Mm)</div><div class="ttdoc">Calculate molar mass of the mixture with the compositions contained in the x() input array.</div><div class="ttdef"><b>Definition</b> <a href="#l00143">Gross.cpp:143</a></div></div>
<div class="ttc" id="aGross_8h_html"><div class="ttname"><a href="Gross_8h.html">Gross.h</a></div></div>
<div class="ttc" id="astructxGrs_html"><div class="ttname"><a href="structxGrs.html">xGrs</a></div><div class="ttdef"><b>Definition</b> <a href="bindings_8cpp_source.html#l00228">bindings.cpp:229</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_dfdbda394c3f7a3aa55229f33a559c41.html">cpp</a></li><li class="navelem"><a class="el" href="Gross_8cpp.html">Gross.cpp</a></li>
    <li class="footer">© 2025 - Ronan LE MEILLAT - <a href="https://github.com/sctg-development">SCTG Development</a> </li>
  </ul>
</div>
</body>
</html>
